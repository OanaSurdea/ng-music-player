<!-- Music Player -->
<div
  class="music-player shadow-sm"
  [class.music-player--small]="isMinimized$ | async"
  [ngClass]="showDarkMode ? 'bg-dark' : 'bg-light'"
>
  <div class="row align-items-center">
    <!-- Track Cover & Title -->
    <div class="col-12 col-sm-5 col-md-auto">
      <div class="row align-items-center">
        <app-track-cover
          class="col-12 col-sm-auto"
          [imageUrl]="trackImageUrl$ | async"
        ></app-track-cover>

        <app-track-title
          class="col-12 col-sm text-center text-sm-start ps-0 ps-md-1"
          [title]="selectedTrack$?.value?.title"
          [artist]="selectedTrack$?.value?.artist"
        ></app-track-title>
      </div>
    </div>

    <!-- Music Controls -->
    <div
      class="col-12 col-sm col-md-auto pe-sm-2 pe-md-2 music-player__controls"
    >
      <app-play-controls
        [isPlaying]="isPlaying$ | async"
        (onChange)="handlePlay($event)"
      ></app-play-controls>

      <app-volume-controls
        class="d-none d-sm-block ps-sm-2 ps-lg-4"
        [isMuted]="isMuted$ | async"
        [volume]="volume"
        (onVolumeChange)="handleVolumeChange($event)"
        (onIsMuteChange)="handleIsMuteChange()"
      ></app-volume-controls>
    </div>

    <!-- Track Wave -->
    <app-track
      class="col-12 col-sm-12 col-md"
      [currentTime]="trackProgress$ | async"
      [duration]="trackDuration$ | async"
      [isLoading]="isLoading$ | async"
    ></app-track>

    <app-resize-button
      class="col-auto d-none d-md-block pe-sm-3"
      [isMinimized]="isMinimized$ | async"
      (onMinimize)="handleMinimizeChange()"
    ></app-resize-button>
  </div>

  <!-- Playlist -->
  <app-playlist
    class="row col"
    [selectedTrack]="selectedTrack$ | async"
    [tracks]="tracks$ | async"
    (onTrackChange)="handleTrackChange($event)"
  ></app-playlist>
</div>

<!-- Track section comments -->
<ng-container *ngIf="showComments">
  <app-waveform-comments
    [regions]="iterableRegions"
    [isPlaying]="isPlaying$ | async"
    (onRegionCommentClick)="handleRegionCommentClick($event)"
  ></app-waveform-comments>
</ng-container>
